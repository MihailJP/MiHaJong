MiHaJong 遊び方説明
===================
Copyright (c) 2008-2013 MihailJP, Part of rights reserved


基本ルール
----------
- 後付あり(Ver 2.0.4より片和りのみ禁止できるように)
- 喰い断の有り無しはコンフィグで設定可
- 流し満貫は流局扱いで常に連荘、ただしコンフィグでなくすこともできる
- ダブ風雀頭は４符か２符かを設定可(一部のローカル役も重なると６符などになる場合がある)
- 半荘戦で、トップが返し点に満たない場合は延長戦(西入サドンデス)。
  西四局を終えてもトップが３万点に満たない場合北入し、北場を終えても再延長があるなら帰り東場へ、
  以下何周でも続く(通信対戦では１６周目の北四局まで対応)
- 喰い替えは、デフォルトではなし。喰い替えすると和了り放棄だが一巡おいた場合は問題なし。
  筋喰い替えも禁止（たとえば２３４と持っているところで１をチーして直後に４を捨てることをいう。
  但し遠い筋、たとえば２３４５６７と持っているところで１をチーして７を捨てるのは問題ない）
- 流し満貫は頭ハネに設定していても全員成立が認められる
- 四槓子は裸単騎を和了らないと認められない。四槓子に包はない。
- 九蓮宝燈は暗槓があると認められない。また、萬子でなくても良い
- 大三元、大四喜に対して包が適用される。これらの役満を確定させるポンまたは大明槓をさせた人は、
  その役満で自摸和された時は１人払い、栄和された時は放銃者との折半払い。
  包となった大三元に字一色や四槓子などが付いた場合、それらの分も「含めて」責任払いが適用される(実装上の都合です)。
  但しコンフィグで包を無しにすることも可能
- 設定で「不聴連荘」以外にしている場合、例えオーラスであろうと流局親流れがある。
- 振聴立直あり(自摸れば和了れる)、空聴立直あり(和了れないだけで罰則はない)
- 不聴立直は流局時錯和(何らかの理由で発生したときのための処置)
- オープン立直のありなしをコンフィグで設定可能(オープン立直時全ての牌を開示)。
  立直していない者がオープンリーチに振り込んだ場合は役満払い。ダブル立直をオープンした場合は３飜
- 立直後の暗槓は塔子や順子になっていない牌のみ。
  立直後の送り槓(たとえば444456と持っているところに7を自摸って4をカンすること)は禁止
- 立直縛りをONにしている場合は鳴いていても立直可、ただし鳴いた場合立直、一発、裏ドラは付かず、オープン立直は不可
- 二飜縛り時、一発・ツモ・海底期待の立直あり(結果的に和了れればよい)。
  また、オープン立直だけで和了ってよい(一発については縛りに含めないことも可能)
- 地和は子の第一ツモでの和了り、人和は子の第一ツモ以前の栄和
- チョンボあり。チョンボの場合は積み棒を増やさず(ただし不聴立直発覚時のみ増える)仕切りなおし、
  チョンボ罰符に積み棒はかからない。錯和があったとき、供託点棒はそのまま持ち越し
- その他、様々な項目についてコンフィグで設定可能


基本の操作方法
--------------

### 捨牌の仕方 ###

　自分のツモ番になると牌が選択できるようになります。捨てたい牌にカーソルを合わせ、ボタンを押してください。

　牌にカーソルを合わせると、その牌を捨てた時のシャンテン数(聴牌の時は待ち牌)が表示されます。

　なお、ツモ切りした牌は河で灰色に表示されます。


### 立直の仕方 ###

　門前で聴牌した際には、画面下の「リーチ」ボタンが点灯します
(コンフィグで立直縛りをONにしていた場合は門前でなくても点灯します)。
ボタンを押した後に捨牌するとリーチします。

　リーチしたあとは、当たり牌や暗槓できる牌、花牌のほかは自動でツモ切りを行ないます。


### 暗槓・加槓の仕方 ###

　暗槓や加槓ができる状況では、画面下の「カン」ボタンが点灯します。
このボタンを押すとカンができる牌以外のボタンが全て暗転しますのでカンしたい牌にカーソルを合わせボタンを押してください。

　暗槓ないし加槓が行なわれ、嶺上牌が自摸られます。


### 立直後の暗槓 ###

　リーチしたあと、順子や塔子の一部をなさない暗刻と同じ牌を自摸った時はその牌を暗槓することができます。
暗槓する時は「カン」を押し、ツモ牌を選択、ボタンを押してください。暗槓しない時はそのままツモ切りします。

　立直後の送り槓や、面子構成が変わるような暗槓はできないようになっています。


### 和了りの仕方 ###

　自摸和や栄和ができる状況では、画面下の「ツモ」「ロン」と書かれたボタンが点灯します。それを押すことで和了ることができます。

　但しこのゲームでは **チョンボがありますのでご注意ください。**

　栄和をしない場合、「パス」というボタンを押すとその牌を見逃します。


### 九種九牌の宣言 ###

　コンフィグで九種九牌をありにしている場合、
親は配牌、子は鳴きのない第一ツモの時点で一九字牌が９種類以上ある場合は「九種九牌」ボタンが点灯します。
このボタンを押すと九種九牌で流局となります。

　国士無双を狙うなどの理由で流さない時はそのまま捨牌を行なってください。


### 鳴き仕掛けの仕方 ###

　鳴き仕掛けが可能になる牌が捨てられたとき、画面下の対応するボタンが点灯しますのでそれを押すと鳴きます。
鳴き仕掛けを行わない場合は、「パス」というボタンを押してください。

　任意の場所で右クリックを行なうことによっても鳴きをスルーします。

　なお、 Ver2.1.0 以降、キャンセルボタンでも鳴きをパスできるようになりました。

#### 鳴きに関する一般的な注意 ####

　鳴く面子に赤ドラを含めるかどうかの選択はできません

#### チーに関して ####

　たとえば上家が６を捨てたとき、

- **６** ７ ８ と鳴くには「左チー」
- ５ **６** ７ と鳴くには「嵌チー」
- ４ ５ **６** と鳴くには「右チー」

を押してください。若干わかりにくいですが、ボタンにカーソルを合わせると
どのような形で鳴くかが具体的に表示されますので参考にしてください。


### キーボード操作について ###

　操作はマウスのほか、キーボードでも行えます。

- カーソル直截移動：１２３４５６７８９０－＾￥ (もう1度押すと捨て牌)
- カーソル直截移動：BackSpace (もう1度押すとツモ切り)
- カーソル移動：←↑↓→、HJKL
- 決定、打牌：Enter、Space、Z
- キャンセル：Esc、X


### パッド操作について ###

　Ver2.1.0より、パッドでの操作も行えるようになりました。なお、現在のところ以下の操作方法で固定です。

- カーソル移動：←↑↓→
- 決定、打牌：奇数番ボタン
- キャンセル：偶数番ボタン


オートモードについて
--------------------
　このゲームには、３つのオート機能があります。

　「自動和了」「オートパス」「ツモ切り」は、一度押すとＯＮになり、もう一度押すとＯＦＦになります。
なお、局開始ごとにリセットされます。

　「自動和了」をＯＮにすると、当たり牌が出るかツモるかした時に勝手に和了ってくれます。
但しこのモードでは和了れない牌でも和了ろうとするので、
**片和了りや形聴、振聴の場合は絶対にＯＮにしないで下さい。**

　「オートパス」はＯＮにしている間、全ての鳴き(ロン以外)をパスします。
 
　「ツモ切り」はＯＮにしていると自動的にツモ切りします。
但し当たり牌をツモった場合などは和了るかどうかを聞かれます。


チャットウィンドウについて
--------------------------
　対局中は画面右にチャットログが表示され、チャットログの下に入力欄が表示されています。
入力欄をクリックするか、Tabキーを押すことで、チャット入力が有効になります。
もう一度Tabキーを押すか、入力欄以外の場所をクリックするとチャット入力モードから抜けます。

　チャットメッセージを送信するには、チャット入力欄を有効にした状態でキーボードから発言を入力し、
Enterキーで送信します。


ローカルルール関聯
------------------

### 十三不塔について ###

　コンフィグで十三不塔をありにしている場合、親は配牌、子は鳴きのない第一ツモの時点で対子が１つだけあり、
それ以外の１２枚が全て浮き牌の場合は特別に「アガリ」ボタンが表示されます。
これを押すと役満または満貫(コンフィグに依存)のツモ和了りとして扱われます。

　なお、このときの牌が全て一九字牌であれば国士無双が成立しますので、
十三不塔ではなく国士無双＋天和(または地和)となります。

　十四不塔もこれに準じます。


### 花麻雀について ###

　コンフィグで花牌ありにしている場合は、花牌が４枚または８枚入ります。
花牌が入った分牌山も増え合計１４０ないし１４４枚になり、嶺上牌も４ないし８枚増えるため
ドラ表示牌は３幢目ではなく５ないし７幢目からめくることになります。
このゲームの花麻雀では、王牌全体の枚数も４ないし８枚増え１８ないし２２枚になります
(花牌を誰も抜かないうちに四槓子の聴牌者が出た場合を想定してのことです)。

　花麻雀は四人打ちのみ実装されています。

#### 花牌の晒し方 ####

　花牌をツモった、または花牌が配牌に含まれていた時は「花牌」ボタンを押し、
直後に花牌を選択することで晒すことができます(スペースの都合で晒した花牌は文字だけ表示されます)。
花牌を晒すことで、ドラ１になります。三麻の抜き北と同じです。

　花牌は面子や雀頭に使うことはできませんが、花牌を捨てると
ドラ１の権利を放棄する代わりに安全牌になります(花牌を鳴くことはできません)。
花牌を捨てるには「花牌」ボタンを **押さずに** 、花牌を選択します。

#### 本花について ####

　東家は春と梅、南家は夏と蘭、西家は秋と菊、北家は冬と竹を本花といい
(「本花」の用語自体は台湾で使用されるもので、ほかの地域では「正花」などとも呼ばれる)、
コンフィグで設定されている場合は、これを抜いて晒すと祝儀役が付加され合計でドラ２になります。

#### 花牌を一人でそろえたときの祝儀 ####

　春夏秋冬、梅蘭菊竹をそれぞれ揃えると、コンフィグで設定されていれば役が付きます。
また、８つの花牌を全て抜くと、和了ったときに八仙過海という役満に
(コンフィグで設定されていれば)なります **(花牌を８枚全部抜いても、和了れなければ役満になりません)** 。
なお、 **花牌も嶺上開花の対象となります。**
七搶一(７枚の花牌を抜いて残りの１枚を他家が抜くと役満の出和了りになるルール)はありません。

#### その他 ####

　花牌がドラ表示牌になった場合、花牌がダブドラ(本花はドラ３)になります。
　海底牌が花牌だった場合、これを抜いた時点で嶺上牌を自摸らず流局となります。


### 青天井計算について ###

　コンフィグで青天井計算をONにすると、青天井ルールになります。役満については、
一律親1500万点・子1000万点とする方法と、13飜(ダブル役満は26飜・以下同様)とする方法から選択できます。
この場合、国士無双、十三不塔などは30符として扱います。

　持ち点や和了点は、理論上±21不可思議(2.147e65)点まで保持できます。
これは計算上、子の30符として210飜程度に相当します。


三人打ちについて
----------------
　アーカイブ内には、三人打ち用のクライアントも付属しています。また、四人三
麻用と数牌三麻用のクライアントもあります。

### 四人打ちとの違いについて ###

- 北家がいない(四人三麻では北家が抜け番)
- 萬子の中張牌なし。三色同順は消滅。(数牌三麻を除く)
    - 数牌三麻では萬子の中張牌ではなく、字牌を除いてプレイし、翻牌、混一色など字牌を使用する役が消滅
- ドラ表示牌が一萬の時は、九萬がドラ(数牌三麻を除く)
- チーなし
- 北は面子で使うと客風
- コンフィグで設定してある場合は北が抜きドラ、嶺上牌は8枚、王牌は14枚
- 他家が抜いた北でロンすることができる(役は付かない)
- 北を抜いたときにも嶺上開花が成立する
- 北を4枚抜いても特典は無い(ドラ4になるだけ)
- ツモ和了り時の支払いは親子関係なく折半(コンフィグで変更可)
- 積み棒は１本場につきデフォルトで場200点(コンフィグで設定可)
- 四人三麻では抜け番の北家もツモ和了りの点数を支払う(コンフィグで設定可)


### 開門位置(割れ目)について ##

　次のようになります。

|サイ|四麻|三麻||サイ|四麻|三麻|
|---:|----|----||---:|----|----|
|    |    |    ||  ７|西家|東家|
|  ２|南家|南家||  ８|北家|南家|
|  ３|西家|西家||  ９|東家|西家|
|  ４|北家|東家||１０|南家|東家|
|  ５|東家|南家||１１|西家|南家|
|  ６|南家|西家||１２|北家|西家|


通信対戦について
----------------
　人数が足りなくてCOMを入れて遊ぶ時は、サーバー側で Escape キーか X キーを
押してください。その時接続している人数で遊べます。
　あと、現在のプロトコルの仕様上(そして実装上)信頼性が高くないです。

### 使用するポート ###

- 四人打ち対戦用：50000～50003
- 三人打ち対戦用：50010～50022
- 四人三麻対戦用：50030～50033
- 数牌三麻対戦用：50060～50062
- チャット用(共通)：50020～50023

### 落ち戻りについて ###

　ホストとの接続が切断された場合その局の他家はツモ切り、次の局から AIによる代走となります。
Version 1.8.0 より **再接続ができなくなりましたのでご注意ください。**


ＢＧＭについて
--------------
　BGMは付属していませんが、bgm フォルダーに入れていただくことで再生されます。
MIDIファイル (\*.mid)と OGG Vorbis (\*.ogg) に対応しています。両方入れた場合
はOGGが優先されます。ファイル名は以下を指定します(拡張子は省略してありま
す)。

|ファイル|使用箇所            |備考                                      |
|--------|--------------------|------------------------------------------|
|title   |タイトル画面        |                                          |
|bgm1    |東一局              |                                          |
|bgm2    |東二局              |                                          |
|bgm3    |東三局              |                                          |
|bgm4    |東四局              |東風戦では使用しません                    |
|bgm5    |南一局              |                                          |
|bgm6    |南二局              |                                          |
|bgm7    |南三局              |                                          |
|bgm8    |南四局              |半荘戦では使用しません                    |
|bgm9    |西一局              |                                          |
|bgm10   |西二局              |                                          |
|bgm11   |西三局              |                                          |
|bgm12   |西四局              |                                          |
|bgm13   |北一局              |                                          |
|bgm14   |北二局              |                                          |
|bgm15   |北三局              |                                          |
|bgm16   |北四局              |認識はしますが通常使用しません            |
|bgm17   |白一局              |以下、延長戦用                            |
|bgm18   |白二局              |                                          |
|bgm19   |白三局              |                                          |
|bgm20   |白四局              |                                          |
|bgm21   |発一局              |                                          |
|bgm22   |発二局              |                                          |
|bgm23   |発三局              |                                          |
|bgm24   |発四局              |                                          |
|bgm25   |中一局              |                                          |
|bgm26   |中二局              |                                          |
|bgm27   |中三局              |                                          |
|bgm28   |中四局              |以上、延長戦用                            |
|final   |オーラス            |                                          |
|richi1  |他家の立直時        |                                          |
|richi2  |自家の立直時        |                                          |
|richi3  |自家の追っかけ立直時|                                          |
|opnrichi|オープン立直時      |                                          |
|shibari |二翻縛り時          |コンフィグでONにしていない場合使用しません|
|ending  |半荘終了時          |自分がトップ                              |
|ending2 |半荘終了時          |自分がトップでもラスでもない              |
|ending3 |半荘終了時          |自分がラス                                |
|agari1  |和了画面ジングル    |満貫未満、自分の和了                      |
|agari2  |和了画面ジングル    |満貫以上、自分の和了                      |
|agari3  |和了画面ジングル    |役満、自分の和了                          |
|agari4  |和了画面ジングル    |満貫未満、放銃または被自摸                |
|agari5  |和了画面ジングル    |満貫以上、放銃または被自摸                |
|agari6  |和了画面ジングル    |役満、放銃または被自摸                    |
|agari7  |和了画面ジングル    |満貫未満、他家の栄和                      |
|agari8  |和了画面ジングル    |満貫以上、他家の栄和                      |
|agari9  |和了画面ジングル    |役満、他家の栄和                          |
|pingju  |流局時ジングル      |                                          |


半荘が終わったら
----------------
　半荘が終わったら、未収供託、ウマ、およびオカの清算が行なわれ最終スコアが表示されます。
終了時に残っていた供託点棒はトップ者が取ります。

　終局画面が表示されたら、マウスクリックか決定キーでタイトル画面に戻ります。

### 牌譜について ###

　半荘を終えると、haifu フォルダに牌譜が出力されます。
牌譜はテキスト形式、HTML形式、XML形式で出力され、対局を終えた日時がファイル名となります。
HTML形式、XML形式の牌譜を閲覧するには、「GL-MahjongTile」フォントをインストールしていただく必要があります。
このフォントは [Gutenberg Labo](http://gutenberg.sourceforge.jp/) にて無償公開されています。

※ Windows 7 で OpenType 版の GL-MahjongTile フォントを使っている場合、
Firefoxがフリーズしてしまう現象が起こるようです。そのような場合は、
TrueType 版をお使いください。

　Vista 以降で MiHaJong を C:\Program Files 以下にインストールした場合、
牌譜は C:\Users\\(ユーザー名)\AppData\Roaming\MiHaJong\haifu に出力されます。
それ以外の場合は、 (MiHaJongをインストールしたパス)\haifu に牌譜が出力されます。

### XML形式の牌譜について ###

　Ver.2より、従来のプレーンテキスト、HTML形式に加え、XML形式の牌譜が出力されるようになりました。
従来の形式と比べ、プログラムなどでの解析がしやすい形式です。

　XSLTを用意してあるので、ブラウザで表示した場合は従来のHTML形式牌譜に近い見た目になります。
但し、次の留意事項があります。

- 従来のHTML形式と違い、Unicode補助多言語面(SMP)の麻雀牌コードポイントを使用しています。
  また、横向きの牌はスタイルシートで回転しています。
- Windows 7 の IE10、Firefox では正しく表示されます。
- Google Chrome では、普通に起動した場合は何も表示されません。
  表示するには、 `--allow-file-access-from-files` オプションを付けて起動する必要があります。
  このオプションを付けた場合、正しく表示されます。
- Opera では牌が文字化けし、読めません。
  なお、Opera ブラウザは Webkit エンジンに移行する予定がありますが、移行後はこの注意が当てはまらなくなります。

### テキスト形式の牌譜の見方 ###

|記号                            |説明                                                                        |
|--------------------------------|----------------------------------------------------------------------------|
|一～九(通常の漢数字)            |萬子                                                                        |
|①～⑨(丸囲み数字)              |筒子                                                                        |
|１～９(全角数字)                |索子                                                                        |
|東南西北白發中                  |字牌                                                                        |
|壱～玖(難しいほうの漢数字)      |萬子の赤ドラ                                                                |
|⑪～⑲(10を加算した丸囲み数字)  |筒子の赤ドラ                                                                |
|Ⅰ～Ⅸ(大文字のローマ数字)      |索子の赤ドラ                                                                |
|ＥＳＷＮＰＦＣ                  |字牌の赤ドラ(現在ＷＮＰのみ使用)                                            |
|甲～壬(十干)                    |萬子の青ドラ(現在甲戊壬のみ使用)                                            |
|い～り(いろは順の平仮名)        |筒子の青ドラ(現在いほりのみ使用)                                            |
|ⅰ～ⅸ(小文字のローマ数字)      |索子の青ドラ(現在ⅰⅴⅸのみ使用)                                            |
|ｅｓｗｎｐｆｃ                  |字牌の青ドラ(現在ｆのみ使用)                                                |
|春夏秋冬梅蘭菊竹                |花牌(四麻のみ)                                                              |
|百                              |百搭(未使用)                                                                |
|↓                              |ツモ切り                                                                    |
|＜ポン[發]發發                  |上家から発をポンしたことを表す                                              |
|∧▽カン五[伍五]五              |対面から五萬をポンし、後に赤五萬を加槓                                      |
|＞カン３３３[Ⅲ]                |下家の捨てた赤三索を大明槓                                                  |
|＜チー[⑦]⑥⑧                  |七筒を嵌張としてチーしたことを表す                                          |
|◇カン東東東東                  |東を暗槓したことを表す                                                      |
|ドラ：⑥ 三                     |ドラは六筒、槓ドラは三萬である事を表す(実際にドラになっている牌が書かれます)|
|チー、ポン、カン                |鳴いた牌を表す(槓の場合は嶺上牌が右に書かれる)                              |
|リーチ                          |リーチ宣言牌を表す                                                          |
|ツモ                            |その牌でツモ和了りしたことを表す                                            |
|ウチ                            |その牌で振り込んだことを表す                                                |
|リ×                            |リーチ宣言牌で振り込んだことを表す                                          |
|カン×                          |搶槓されたことを表す                                                        |
|花                              |花牌を抜いたことを表す(四麻のみ)                                            |
|抜                              |北を抜いたことを表す(三麻のみ)                                              |
|抜×                            |搶北されたことを表す(三麻のみ)                                              |

※通常ドラ表示牌１枚に付き１つのドラが設定されますが、
コンフィグで設定していた場合に限りドラ表示牌１枚で３つのドラが設定されるので、その時はドラが３つずつ書かれます。

　例：ドラ：②③④ 九一二


------------------------------------------------------------------------------

_Finis_
